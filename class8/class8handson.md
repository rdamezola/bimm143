Class8:
================
Robertha Amezola
April 25, 2019

K-means clustering
------------------

Example of running the **kmeans()** function

``` r
tmp <- c(rnorm(30,-3), rnorm(30,3))
x <- cbind(x=tmp, y=rev(tmp))
plot(x)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-1-1.png)

To Do

-Use the kmeans() function setting k to 2 and nstart=20 -Inspect/print the results &gt;Q. How many points are in each cluster? 45

``` r
km=kmeans(x, centers=2, nstart=20)
```

``` r
km$cluster
```

    ##  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1
    ## [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

``` r
km$size
```

    ## [1] 30 30

``` r
km$centers
```

    ##           x         y
    ## 1  3.129015 -3.046635
    ## 2 -3.046635  3.129015

``` r
plot(x, col=km$cluster)
points(km$centers, pch=18, col="blue", cex=3)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-6-1.png)

> Q. What ‘component’ of your result object details - cluster size? - cluster assignment/membership? - cluster center?

> Plot x colored by the kmeans cluster assignment and add cluster centers as blue points

``` r
km <- kmeans(x, centers=2, nstart=20)
```

\#\#Hierarchical Clustering example

**hclust** function a distance matrix not the raw data as an input

``` r
##distanc ematrix calculation
d <- dist(x)

##clustering
hc<-hclust(d)
plot(hc)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-8-1.png)

\# Create hierarchical cluster model: hc hc &lt;- hclust(dist(x)) \# We can plot the results as a dendrogram plot(hc) &gt;What do you notice? the grah is hard to read &gt;Does the dendrogram? every cluster (point) is then group into similar groupds &gt;make sense based on? yes but you have to understand that is backgrads &gt;your knowledge of x

\#\#drwas dendrogram

``` r
plot(hc)
abline(h=6, col="red")
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-9-1.png)

\#\# \# Cut into k grps can chang k

``` r
cutree(hc, k=2)
```

    ##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2
    ## [36] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Step 1. Generate some example data for clustering
-------------------------------------------------

``` r
x <- rbind(
 matrix(rnorm(100, mean=0, sd = 0.3), ncol = 2), # c1
 matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2), # c2
 matrix(c(rnorm(50, mean = 1, sd = 0.3), # c3
 rnorm(50, mean = 0, sd = 0.3)), ncol = 2))
colnames(x) <- c("x", "y")
```

\#\# Step 2. Plot the data without clustering

``` r
plot(x)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-12-1.png)

\# Step 3. Generate colors for known clusters \# (just so we can compare to hclust results)

``` r
col <- as.factor( rep(c("c1","c2","c3"), each=50) )
plot(x, col=col)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-13-1.png)

> Use the dist(), hclust(), plot() and cutree() functions to return 2 and 3 clusters

``` r
hc<- hclust(dist(x))
plot(hc)
abline(h=2, col="red")
abline(h=2.8, col="blue")
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-14-1.png)

``` r
gp2 <- cutree(hc, k=4)
gp3<-cutree(hc, k=5)
```

``` r
gp2
```

    ##   [1] 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
    ##  [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 3 4 4 3 4 4 3 3 4 4 1 4 4 3 3 3 3 3
    ##  [71] 4 3 3 3 4 4 3 4 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 4 3 3 4 3 4 3 2 2 2 2 2
    ## [106] 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 4 4 4 2 2 4 2 4 2 2 2 2 2 2 2 1 1 2 4
    ## [141] 4 4 4 2 2 2 2 2 2 2

``` r
gp3
```

    ##   [1] 1 2 2 1 2 1 1 1 3 2 1 2 1 2 1 1 2 3 2 2 1 2 1 2 1 2 1 2 1 1 2 2 1 2 1
    ##  [36] 1 1 2 2 1 1 1 2 1 1 2 1 2 1 1 4 4 4 5 5 4 5 5 4 4 5 5 1 5 5 4 4 4 4 4
    ##  [71] 5 4 4 4 5 5 4 5 4 4 4 4 4 4 4 4 4 4 5 4 4 4 4 5 4 4 5 4 5 4 3 3 3 3 3
    ## [106] 3 3 5 5 3 3 3 3 3 3 3 3 3 3 3 3 5 5 5 3 3 5 3 5 3 3 3 3 3 3 3 2 1 3 5
    ## [141] 5 5 5 3 3 3 3 3 3 3

``` r
plot(x, col=gp3)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-18-1.png)

``` r
plot(x, col=gp2)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-19-1.png)

\#\#PCA analysis **prcomp()**

``` r
mydata <- read.csv("https://tinyurl.com/expression-CSV",
 row.names=1)
```

\#\# tells you how many rows \#100 genes

``` r
nrow(mydata)
```

    ## [1] 100

how many experiment in colums
=============================

``` r
ncol(mydata)
```

    ## [1] 10

colum name
----------

``` r
colnames(mydata)
```

    ##  [1] "wt1" "wt2" "wt3" "wt4" "wt5" "ko1" "ko2" "ko3" "ko4" "ko5"

``` r
head(t (mydata))
```

    ##     gene1 gene2 gene3 gene4 gene5 gene6 gene7 gene8 gene9 gene10 gene11
    ## wt1   439   219  1006   783   181   460    27   175   658    121    337
    ## wt2   458   200   989   792   249   502    30   182   669    116    337
    ## wt3   408   204  1030   829   204   491    37   184   653    134    330
    ## wt4   429   210  1017   856   244   491    29   166   633    117    322
    ## wt5   420   187   973   760   225   493    34   180   657    133    313
    ## ko1    90   427   252   849   277   612   304   255   628    931    100
    ##     gene12 gene13 gene14 gene15 gene16 gene17 gene18 gene19 gene20 gene21
    ## wt1    214    789    458    551    390    900    951    436    244    119
    ## wt2    194    738    490    555    400    970    991    414    266     87
    ## wt3    213    807    493    527    403    905    991    388    228     87
    ## wt4    192    768    446    552    402    850    983    418    223     88
    ## wt5    207    820    496    503    401    834    984    410    240     93
    ## ko1     97    293    694    712    755    353    217    162    540    914
    ##     gene22 gene23 gene24 gene25 gene26 gene27 gene28 gene29 gene30 gene31
    ## wt1    156     89    570    788   1007    937    224    809    624    218
    ## wt2    170     97    567    796    972    876    232    869    598    259
    ## wt3    150     96    563    766    977    901    231    815    587    213
    ## wt4    167     97    587    778   1003    958    238    788    552    204
    ## wt5    155     82    563    825   1027    957    226    781    592    213
    ## ko1    346    788    424    456    945    414    850    482    956     69
    ##     gene32 gene33 gene34 gene35 gene36 gene37 gene38 gene39 gene40 gene41
    ## wt1    906    262    155    100    117    286    321    388    606    379
    ## wt2    798    291    172    104    147    262    353    372    576    377
    ## wt3    828    258    173     94    120    260    334    345    558    362
    ## wt4    874    271    173    114    147    270    340    373    581    346
    ## wt5    890    279    192     90    145    293    316    359    574    354
    ## ko1    541    534    643    212    353    360    642     50    415    991
    ##     gene42 gene43 gene44 gene45 gene46 gene47 gene48 gene49 gene50 gene51
    ## wt1    471    592    755     35    758     24    100    809    955    453
    ## wt2    492    615    733     40    734     25    113    825    994    419
    ## wt3    473    602    775     28    704     12    136    833    994    443
    ## wt4    470    602    687     25    761     13    117    800    975    459
    ## wt5    471    655    776     32    672     22    103    776    973    469
    ## ko1    401    514    255    947    567    324    912    538    175    174
    ##     gene52 gene53 gene54 gene55 gene56 gene57 gene58 gene59 gene60 gene61
    ## wt1    327    657    678    304    659    673    785    501    232    928
    ## wt2    320    669    638    325    687    668    772    513    228    936
    ## wt3    324    631    676    312    659    694    817    462    193   1015
    ## wt4    321    701    683    327    667    699    766    484    247    971
    ## wt5    318    647    671    320    639    726    784    504    231    964
    ## ko1    489    246    259    819    109     18    467     37    997    428
    ##     gene62 gene63 gene64 gene65 gene66 gene67 gene68 gene69 gene70 gene71
    ## wt1    159    336    968    339     35     27     80    744    766    672
    ## wt2    169    344    888    335     32     28     69    685    739    736
    ## wt3    163    372    907    373     45     25     87    733    751    672
    ## wt4    151    389    914    338     37     35     87    693    720    715
    ## wt5    166    357    883    328     38     27     81    746    738    693
    ## ko1    869    664    886    275    765    200    693    745    645    839
    ##     gene72 gene73 gene74 gene75 gene76 gene77 gene78 gene79 gene80 gene81
    ## wt1    526    627    468    986    348    719    883    837    666    804
    ## wt2    553    650    466    945    333    714    899    883    657    735
    ## wt3    534    664    477   1006    344    734    868    864    719    771
    ## wt4    511    622    469   1020    321    693    873    807    656    763
    ## wt5    529    606    494   1024    296    682    882    854    638    813
    ## ko1    922    805    703    359    770    620    803    210    549    613
    ##     gene82 gene83 gene84 gene85 gene86 gene87 gene88 gene89 gene90 gene91
    ## wt1    476    438    938     29    810    575    451    174    158    371
    ## wt2    494    430    934     29    830    579    471    170    122    367
    ## wt3    521    477    976     30    760    567    494    205    138    369
    ## wt4    494    457    965     19    796    565    447    175    159    339
    ## wt5    482    481    960     21    807    576    470    179    128    360
    ## ko1    183    466    904    618    486    352    540    298    863    103
    ##     gene92 gene93 gene94 gene95 gene96 gene97 gene98 gene99 gene100
    ## wt1    853    208    555    527    589    396     33    321      25
    ## wt2    798    214    584    573    607    384     27    343      34
    ## wt3    866    200    574    548    579    382     39    349      34
    ## wt4    843    196    599    548    536    399     42    367      36
    ## wt5    823    206    581    552    583    401     33    343      32
    ## ko1    934    409    292    686    497    460    977    949     661

``` r
prcomp(t(mydata), scale=TRUE)
```

    ## Standard deviations (1, .., p=10):
    ##  [1] 9.623734e+00 1.519849e+00 1.057866e+00 1.052033e+00 8.806163e-01
    ##  [6] 8.254517e-01 8.011116e-01 6.206451e-01 6.034223e-01 3.348364e-15
    ## 
    ## Rotation (n x k) = (100 x 10):
    ##                  PC1           PC2           PC3           PC4
    ## gene1   -0.103666005  0.0041998528  1.681018e-02 -0.0400873337
    ## gene2    0.103514749  0.0262608225  2.640622e-02  0.0305921681
    ## gene3   -0.103761385 -0.0144849026  2.668104e-03  0.0081850075
    ## gene4    0.075320862 -0.0463694299  4.433720e-01  0.3069775803
    ## gene5    0.087428334 -0.1741594374  1.205184e-01 -0.3448068218
    ## gene6    0.099670829  0.0465122986  1.223749e-01 -0.0174274757
    ## gene7    0.103609009  0.0061228220  3.239851e-02 -0.0073582305
    ## gene8    0.100759370 -0.0876764723 -8.409933e-02  0.0084857868
    ## gene9   -0.085460936  0.0758021460  2.225346e-01 -0.2009424414
    ## gene10   0.103783379  0.0082840559 -2.049816e-03  0.0164287021
    ## gene11  -0.103719665 -0.0012793155  2.720853e-02 -0.0154190000
    ## gene12  -0.102001924  0.0305389988  4.592960e-02  0.1053437560
    ## gene13  -0.103399591 -0.0222561053 -5.761585e-02  0.0541561557
    ## gene14   0.102478762  0.0302536287  1.164708e-02  0.0023477923
    ## gene15   0.099993193  0.0178998003  2.055467e-01  0.0504400514
    ## gene16   0.103598474 -0.0103141833 -3.496931e-03 -0.0348168938
    ## gene17  -0.103013773 -0.0072505473  5.945251e-02 -0.0264209692
    ## gene18  -0.103774699 -0.0121606479 -2.576304e-03 -0.0125996283
    ## gene19  -0.103390599 -0.0086488160 -1.091989e-03 -0.0474315888
    ## gene20   0.103121803  0.0180302741 -2.475444e-02 -0.0516494468
    ## gene21   0.103787935  0.0204607746  1.554369e-03  0.0077857617
    ## gene22   0.102725125  0.0019104392  5.553309e-02  0.0401373008
    ## gene23   0.103681565  0.0154856533  4.480013e-02  0.0043208738
    ## gene24  -0.098284250 -0.1414239302 -4.835175e-02  0.0620714404
    ## gene25  -0.103302326  0.0354055029 -5.148691e-02 -0.0251238158
    ## gene26  -0.085745836  0.1647495874 -4.003583e-01 -0.0286103319
    ## gene27  -0.103374849 -0.0069715410 -1.546843e-02  0.0228376680
    ## gene28   0.103638752 -0.0215349592 -1.547582e-02 -0.0193954592
    ## gene29  -0.102739689 -0.0001093090  3.730029e-02 -0.0435770803
    ## gene30   0.103044435  0.0162628338  1.392149e-02 -0.0006574407
    ## gene31  -0.101768804 -0.0344459201  6.076867e-02 -0.1517332137
    ## gene32  -0.100677376 -0.0621394552 -5.828390e-02  0.0910263462
    ## gene33   0.103592988 -0.0105471373  7.383923e-03 -0.0215752851
    ## gene34   0.103525731  0.0158309318 -1.113415e-02  0.0301088633
    ## gene35   0.102382706  0.0023712606  4.140746e-02  0.0552796570
    ## gene36   0.103412422  0.0060691377 -4.220432e-02 -0.0526948600
    ## gene37   0.100467583 -0.0096404975 -1.485354e-01 -0.0095463269
    ## gene38   0.102080752  0.0796448670  4.668636e-02 -0.0098089178
    ## gene39  -0.103744482  0.0045568817  2.615448e-03 -0.0222520335
    ## gene40  -0.102003831  0.0511647011  3.679754e-02  0.0422002347
    ## gene41   0.103716818  0.0117599146 -7.139583e-03  0.0015017014
    ## gene42  -0.098746675  0.0278268868  5.217223e-02  0.0050749991
    ## gene43  -0.092001819 -0.1270949250 -1.137152e-01 -0.1104566126
    ## gene44  -0.103504699 -0.0037099172 -4.445367e-02  0.0174618035
    ## gene45   0.103840183  0.0032677489  6.751089e-03  0.0029118961
    ## gene46  -0.096571619  0.0433705472  1.597474e-01  0.1043263268
    ## gene47   0.103502386  0.0429423245  1.009689e-02 -0.0315251351
    ## gene48   0.103682769 -0.0043841753  3.370447e-02 -0.0012646184
    ## gene49  -0.103188532 -0.0025700478  8.554684e-02 -0.0151383987
    ## gene50  -0.103743341 -0.0068613634  1.083808e-02  0.0079017082
    ## gene51  -0.103265591  0.0162003991 -7.237098e-02  0.0236954316
    ## gene52   0.102519795  0.0236440060 -7.650467e-02 -0.0378687503
    ## gene53  -0.103245619 -0.0248408452  2.634062e-02 -0.0069869895
    ## gene54  -0.103584153 -0.0150762696 -3.559554e-02  0.0116052801
    ## gene55   0.103695870  0.0177887386  2.060975e-02 -0.0198839436
    ## gene56  -0.103783479 -0.0066176872  2.450131e-02 -0.0151062037
    ## gene57  -0.103703675 -0.0178547138 -2.933228e-02  0.0061090134
    ## gene58  -0.103503980 -0.0220420088 -1.054998e-02  0.0404348016
    ## gene59  -0.103607438 -0.0163545075 -2.175728e-02 -0.0298192340
    ## gene60   0.103805515  0.0209435507  8.750169e-04 -0.0061934233
    ## gene61  -0.103308945 -0.0491951171 -1.019799e-02  0.0330856979
    ## gene62   0.103713893 -0.0203867411  1.667188e-04  0.0097197017
    ## gene63   0.101468649  0.0790783469  6.135882e-02  0.0181085271
    ## gene64  -0.078643996  0.1973838533  3.030327e-02  0.1494469104
    ## gene65  -0.094219475 -0.0912614907  2.347099e-01  0.2160610168
    ## gene66   0.103845454  0.0174126434  5.653162e-03  0.0061226005
    ## gene67   0.103453646  0.0045005847 -2.463217e-03 -0.0477081276
    ## gene68   0.103839510  0.0084779808  7.759101e-03  0.0053000299
    ## gene69   0.048197107  0.3382284557 -2.412572e-01  0.5338731531
    ## gene70  -0.101365212  0.0838144481 -5.846625e-02 -0.0139986566
    ## gene71   0.095664760 -0.0922410436 -9.694116e-02 -0.2173291686
    ## gene72   0.102347342  0.0817281672 -3.338927e-02 -0.0622732648
    ## gene73   0.102001050 -0.0447953803  7.475967e-02  0.0128421661
    ## gene74   0.101747637  0.0305850868 -1.012645e-01 -0.0823072451
    ## gene75  -0.103592371 -0.0224442979 -2.724612e-02  0.0240991482
    ## gene76   0.103514464  0.0178695785  4.630953e-02  0.0155168814
    ## gene77  -0.097473626  0.0846018210  1.266348e-01  0.0012635530
    ## gene78  -0.100499426  0.0789419015  3.615472e-02 -0.1674404462
    ## gene79  -0.103639415 -0.0199674783  9.666381e-03 -0.0111078974
    ## gene80  -0.093476477 -0.1356720549  7.098727e-02  0.2417740332
    ## gene81  -0.100659777  0.0331143580 -1.819483e-01  0.0500866134
    ## gene82  -0.103481127 -0.0311424266  3.190314e-02 -0.0029357060
    ## gene83   0.066065263 -0.4085578114 -3.821719e-01  0.1368945485
    ## gene84  -0.009263882 -0.6342794983  1.571527e-02  0.1661011072
    ## gene85   0.103698370  0.0176538324 -2.006515e-02 -0.0191353964
    ## gene86  -0.102122719 -0.0390750828 -3.554197e-02 -0.0708696251
    ## gene87  -0.103448562  0.0213539470  2.682192e-02 -0.0487617089
    ## gene88   0.098226585 -0.1088627079 -3.192910e-02  0.0753863801
    ## gene89   0.100038548 -0.0112867314 -1.286266e-02  0.0664434087
    ## gene90   0.103777744 -0.0012845111 -4.108083e-04  0.0061816698
    ## gene91  -0.103698408  0.0084542821  1.826177e-04 -0.0177477329
    ## gene92   0.092534408 -0.1313040655 -1.619390e-02  0.1816368351
    ## gene93   0.102950950  0.0007911228 -4.591574e-02 -0.0833644300
    ## gene94  -0.102692869 -0.0790761495 -5.754168e-05 -0.0194979942
    ## gene95   0.102142492 -0.0669992711  4.367738e-02 -0.1003173743
    ## gene96  -0.096658194  0.0866844285 -5.433340e-02 -0.1248824689
    ## gene97   0.100787961  0.0891876374 -1.444994e-01  0.0247329056
    ## gene98   0.103837190 -0.0065993437 -3.368433e-04  0.0025158616
    ## gene99   0.103649598  0.0159924285  2.999692e-02  0.0354191943
    ## gene100  0.103870820  0.0006596780 -1.506233e-04  0.0015538105
    ##                   PC5          PC6           PC7           PC8
    ## gene1   -0.0073284012  0.039039227  0.0031207157  0.0501452777
    ## gene2   -0.0279059794 -0.036752676  0.0494281585  0.0517973635
    ## gene3   -0.0224332286  0.004627918  0.0346274136 -0.0516827685
    ## gene4   -0.2629108337  0.302182614 -0.0833109067 -0.2549384374
    ## gene5   -0.0683092948  0.295802736 -0.1028045751 -0.0965872556
    ## gene6    0.0547464545  0.123596861 -0.2439601121 -0.1324475637
    ## gene7    0.0226519999 -0.057847869 -0.0022425225 -0.0157714887
    ## gene8    0.1147317801 -0.029858559  0.1114106654  0.1194999079
    ## gene9    0.3212622427 -0.323659901 -0.2761909018  0.1326772803
    ## gene10   0.0341037926 -0.016820435  0.0300202059  0.0223699123
    ## gene11   0.0068338246 -0.021846029  0.0560315396 -0.0009977065
    ## gene12   0.1120984338 -0.067727265 -0.0173420416  0.0142412671
    ## gene13   0.0150394185  0.007948824 -0.0395245939 -0.0297844414
    ## gene14   0.1208849891 -0.016410337 -0.1363041251 -0.0520604650
    ## gene15   0.0520504400  0.009180907  0.0447145437  0.2009347965
    ## gene16  -0.0398306730 -0.053277473 -0.0340216907 -0.0331165650
    ## gene17   0.0492004688  0.008899798  0.0162802934  0.0447045638
    ## gene18   0.0041706321  0.034636657 -0.0009726272 -0.0561900838
    ## gene19  -0.0547135016 -0.033216637  0.0359259045  0.0689829549
    ## gene20   0.0557451262 -0.029263328  0.0931064091  0.0603457828
    ## gene21  -0.0037265027 -0.034226971 -0.0050795723  0.0350242232
    ## gene22   0.0792163753  0.072972284  0.0434385971  0.1378985831
    ## gene23   0.0105658817 -0.030583774 -0.0155475433  0.0119611480
    ## gene24  -0.0508416262  0.163438377  0.1125783141  0.2219913913
    ## gene25   0.0421736157  0.063607037 -0.0119924939 -0.0120000812
    ## gene26  -0.2299668170  0.137169306 -0.0429793336 -0.2091821056
    ## gene27  -0.0300341794  0.029902105 -0.0042081109 -0.0017033943
    ## gene28  -0.0027304844 -0.037714640  0.0597114218  0.0212859551
    ## gene29   0.0698102801  0.042632469  0.0612120736  0.0334801646
    ## gene30   0.0165529093 -0.103806721 -0.0755620781  0.1050033255
    ## gene31   0.0614741927 -0.050674838  0.0291964242  0.0484657650
    ## gene32  -0.0590423432 -0.020604794 -0.0351474786  0.2221149534
    ## gene33   0.0439027768  0.030588726 -0.0041592678  0.0890673608
    ## gene34   0.0663083720  0.041295729  0.0312100881  0.0287001806
    ## gene35  -0.0550542103  0.114848624 -0.0642783664  0.1239720972
    ## gene36  -0.0117649953  0.075382723  0.0100913709 -0.0027434761
    ## gene37  -0.0854594211 -0.069085848 -0.1634262595  0.1786694594
    ## gene38  -0.0495619153  0.046968468 -0.1111686318 -0.0779024411
    ## gene39  -0.0376053432  0.009039161  0.0244320706  0.0494095206
    ## gene40   0.0265631269  0.024057368  0.0930933985  0.1870123296
    ## gene41  -0.0049310554 -0.025845651 -0.0216960990  0.0478727968
    ## gene42   0.2105654115  0.213176614  0.0948841733  0.1365182444
    ## gene43   0.0521054387  0.080202808 -0.4673813847  0.0318296274
    ## gene44   0.0608463513 -0.037266725 -0.0324508277 -0.0366347604
    ## gene45   0.0168590570 -0.021702030  0.0073669730  0.0419306558
    ## gene46  -0.1727016649  0.163381506  0.1279081271  0.2933410737
    ## gene47   0.0006010277 -0.052072914 -0.0063889674 -0.0071334291
    ## gene48   0.0200823402 -0.048921096  0.0241298608 -0.0044205873
    ## gene49  -0.0036527226 -0.053398438  0.0024181840 -0.0848835496
    ## gene50   0.0322449227  0.047616245  0.0148283527 -0.0311197652
    ## gene51  -0.0334784432  0.040564328  0.0154559421 -0.0632392025
    ## gene52  -0.0474355993 -0.071112578  0.1160706002 -0.0567518037
    ## gene53  -0.0608537061  0.097426648 -0.0156797374  0.0504556602
    ## gene54  -0.0603415929 -0.003011149  0.0046060565 -0.0574862511
    ## gene55  -0.0229807361 -0.013031782 -0.0524376573 -0.0183338429
    ## gene56   0.0030551493  0.032153538  0.0276503490 -0.0095227361
    ## gene57   0.0051980327  0.038789296 -0.0073691608 -0.0413665506
    ## gene58   0.0136683206 -0.025241413 -0.0434385684 -0.0678963285
    ## gene59   0.0192496621  0.041403993  0.0143121280  0.0732349809
    ## gene60  -0.0178649390  0.001650033 -0.0083055516  0.0375964974
    ## gene61   0.0085598807  0.021227820  0.0101281494 -0.1034364531
    ## gene62   0.0195415527 -0.015666122 -0.0116959403  0.0700024323
    ## gene63  -0.0584356404  0.025417425 -0.0614538660 -0.2108720143
    ## gene64  -0.4741386412 -0.421034483  0.0535654660  0.1916206051
    ## gene65   0.1301520767 -0.154685825  0.0021780116 -0.2026490005
    ## gene66   0.0030546655 -0.024713136 -0.0049152028 -0.0026893461
    ## gene67  -0.0427020607 -0.054437541  0.0500887290 -0.0319973954
    ## gene68  -0.0113354820 -0.033755567 -0.0115145324 -0.0020451378
    ## gene69   0.3816277979  0.165312055 -0.0741205218  0.0893273977
    ## gene70  -0.0410618491 -0.168888536 -0.0085671193 -0.0936718640
    ## gene71  -0.0150743546  0.097061576  0.2875863387  0.0564466753
    ## gene72   0.0047621461 -0.042148957  0.0318180468 -0.1131020329
    ## gene73   0.0796964012 -0.086068497  0.1140635063 -0.0152299326
    ## gene74  -0.0387861164 -0.100900781  0.0258906221 -0.1676251329
    ## gene75  -0.0195596944  0.026053396 -0.0032402409 -0.0539444602
    ## gene76  -0.0156349911 -0.068484087 -0.0086386548  0.0230101578
    ## gene77   0.0943481214 -0.192338015  0.2344624890 -0.2133027523
    ## gene78   0.0470646591 -0.061568496  0.0994025976 -0.0688032405
    ## gene79   0.0683469512  0.010952030  0.0024597652  0.0020331771
    ## gene80   0.0594547273 -0.103014331  0.0523952167 -0.1413126722
    ## gene81  -0.0831712872 -0.061233593 -0.1245524760 -0.0211462268
    ## gene82   0.0008135250 -0.010374137  0.0010997576 -0.1107872477
    ## gene83   0.0948503679 -0.057976798  0.0896661903 -0.1657223777
    ## gene84   0.0040425823 -0.150112474 -0.0171914526  0.1176372189
    ## gene85  -0.0104317472 -0.044444267  0.0317523738 -0.0173172875
    ## gene86  -0.0532041436  0.059770227 -0.0943527948  0.1499489614
    ## gene87  -0.0009325166 -0.033748571 -0.0235529473 -0.0577851905
    ## gene88   0.1213655026 -0.017960620 -0.1835525773 -0.0313320014
    ## gene89   0.1392744435 -0.095020117  0.2379345148 -0.1484065484
    ## gene90  -0.0393602058 -0.037470480 -0.0033780933  0.0289487113
    ## gene91   0.0363096934 -0.050741851  0.0235532979 -0.0327632214
    ## gene92  -0.2468986808 -0.155874756 -0.2812733893  0.0427590075
    ## gene93  -0.0315451799 -0.091771102  0.0279551782 -0.0037010419
    ## gene94   0.0139350350  0.087484786  0.0655476760  0.0074784349
    ## gene95   0.0974764416  0.004725604  0.0629106132  0.0195319238
    ## gene96   0.1253063153 -0.119737935 -0.2071057806  0.0438704639
    ## gene97  -0.0608263271  0.098229017  0.0609462263  0.0357499998
    ## gene98   0.0054352574 -0.028403172  0.0251269760  0.0271305359
    ## gene99   0.0269369511  0.040515143 -0.0102683116  0.0164790141
    ## gene100 -0.0080042670 -0.012504985 -0.0205176245  0.0182299794
    ##                  PC9          PC10
    ## gene1    0.036905029  0.0238379941
    ## gene2    0.012169567  0.0503829119
    ## gene3    0.015189351  0.0651004365
    ## gene4    0.002984558  0.2076358113
    ## gene5   -0.038832301  0.0925589172
    ## gene6   -0.019992235 -0.1740587627
    ## gene7   -0.067972833 -0.0577695165
    ## gene8    0.163085155 -0.0891530402
    ## gene9   -0.091347772  0.4877168730
    ## gene10  -0.016860518  0.0011508750
    ## gene11   0.022463374  0.0022686051
    ## gene12  -0.133048061 -0.1313842894
    ## gene13  -0.018731439  0.0475789801
    ## gene14   0.040533567 -0.0109040644
    ## gene15  -0.106540977 -0.1911459609
    ## gene16   0.011954523  0.0120500533
    ## gene17   0.161106084  0.0747396973
    ## gene18   0.008401576  0.0314544220
    ## gene19  -0.065646279 -0.0240751976
    ## gene20   0.045692752  0.0148681746
    ## gene21  -0.004922879 -0.0145139987
    ## gene22  -0.033075269  0.0417819731
    ## gene23  -0.041688486 -0.0279351737
    ## gene24   0.116514640  0.0120930212
    ## gene25  -0.047254607 -0.0393203702
    ## gene26   0.107444249 -0.0034013321
    ## gene27  -0.148141698 -0.0520148564
    ## gene28   0.006698702  0.0145024009
    ## gene29   0.172870950  0.0616168795
    ## gene30   0.028303539 -0.0402990270
    ## gene31   0.079424182  0.0617212486
    ## gene32  -0.213304965 -0.1734519597
    ## gene33   0.012370271  0.0202030765
    ## gene34  -0.019829383  0.0044328541
    ## gene35   0.104189303  0.0226715777
    ## gene36   0.031035390  0.0162073590
    ## gene37  -0.070259191  0.0435754730
    ## gene38   0.105057003  0.0567030384
    ## gene39  -0.016527459  0.0346647674
    ## gene40  -0.137054008 -0.0602897114
    ## gene41   0.067774824 -0.0494250679
    ## gene42   0.194252874 -0.0446688466
    ## gene43  -0.100879791 -0.0506404410
    ## gene44   0.022878451 -0.0194698712
    ## gene45  -0.001218816 -0.0094740369
    ## gene46   0.131962968  0.0974256325
    ## gene47  -0.035484331 -0.0358295643
    ## gene48  -0.044541861 -0.0329778155
    ## gene49   0.042018673 -0.0260421546
    ## gene50   0.008484579  0.0102218023
    ## gene51  -0.066026805  0.1045211060
    ## gene52   0.075373509  0.1097342753
    ## gene53  -0.004936199  0.0196042873
    ## gene54  -0.011618554  0.0607131045
    ## gene55  -0.011665650 -0.0847964207
    ## gene56   0.021389901  0.0464876604
    ## gene57  -0.036393650  0.0058740977
    ## gene58   0.056761771 -0.1022750701
    ## gene59   0.008476928  0.0486813260
    ## gene60  -0.017466935  0.0045495730
    ## gene61   0.013013858 -0.0142924433
    ## gene62   0.026888487 -0.0235596514
    ## gene63  -0.114476833  0.0700022908
    ## gene64   0.030109204  0.0591767509
    ## gene65  -0.001399966 -0.3436776280
    ## gene66  -0.007093339 -0.0232269929
    ## gene67  -0.045371731 -0.0003013748
    ## gene68  -0.018508144 -0.0371590050
    ## gene69  -0.071309674  0.1462348214
    ## gene70   0.103995348 -0.1538904359
    ## gene71   0.157672616 -0.0309782050
    ## gene72   0.075446343 -0.0232754781
    ## gene73   0.137820485  0.0545182264
    ## gene74  -0.043568731  0.1052684200
    ## gene75  -0.065786716  0.0156919368
    ## gene76   0.038975013  0.0332413659
    ## gene77  -0.042124548 -0.0026639119
    ## gene78  -0.119619883 -0.1627996987
    ## gene79   0.029881328 -0.0122572741
    ## gene80   0.400664906  0.2015011143
    ## gene81  -0.056720559  0.1180650940
    ## gene82   0.010741501  0.0491684076
    ## gene83  -0.052311676  0.0625571197
    ## gene84  -0.174126284  0.1088825955
    ## gene85   0.028524489  0.0030130695
    ## gene86   0.112364288 -0.0825403305
    ## gene87  -0.073152329  0.0771531312
    ## gene88   0.322822828 -0.1507531743
    ## gene89  -0.069259760  0.0869921438
    ## gene90   0.003756086 -0.0083126612
    ## gene91   0.003361823  0.0261704675
    ## gene92   0.203121146 -0.0111935329
    ## gene93   0.059761246  0.0420842599
    ## gene94  -0.027522401  0.0724810333
    ## gene95  -0.006155912  0.1698727958
    ## gene96   0.357620649 -0.0293725239
    ## gene97  -0.110509396  0.2989322771
    ## gene98  -0.008692987 -0.0538474549
    ## gene99  -0.021081692 -0.0735156379
    ## gene100  0.022933185 -0.0410250614

\#name pca

``` r
pca <- prcomp(t(mydata), scale=TRUE)
```

pca plot
========

``` r
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2")
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-27-1.png)

variance capture per PC % in OC
-------------------------------

``` r
pca.var <- pca$sdev^2
pca.var.per <- round(pca.var/sum(pca.var)*100, 1) 

head(pca.var.per) 
```

    ## [1] 92.6  2.3  1.1  1.1  0.8  0.7

``` r
barplot(pca.var.per, main="Scree Plot",
 xlab="Principal Component", ylab="Percent Variation")
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-29-1.png)

``` r
colvec <- colnames(mydata)
colvec[grep("wt", colvec)] <- "red"
colvec[grep("ko", colvec)] <- "blue"

plot(pca$x[,1], pca$x[,2], col=colvec, pch=16,
 xlab=paste0("PC1 (", pca.var.per[1], "%)"),
 ylab=paste0("PC2 (", pca.var.per[2], "%)"))
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-30-1.png)

Hands on session 2
==================

``` r
ukfood<- read.csv("UK_foods.csv", row.names = 1)
```

``` r
ncol(ukfood)
```

    ## [1] 4

``` r
dim(ukfood)
```

    ## [1] 17  4

``` r
rownames(ukfood) <- ukfood[,1]
ukfood <- ukfood[,-1]
head(ukfood)
```

    ##     Wales Scotland N.Ireland
    ## 105   103      103        66
    ## 245   227      242       267
    ## 685   803      750       586
    ## 147   160      122        93
    ## 193   235      184       209
    ## 156   175      147       139

``` r
dim(ukfood)
```

    ## [1] 17  3

``` r
ukfood<- read.csv("UK_foods.csv", row.names=1)
head(ukfood)
```

    ##                England Wales Scotland N.Ireland
    ## Cheese             105   103      103        66
    ## Carcass_meat       245   227      242       267
    ## Other_meat         685   803      750       586
    ## Fish               147   160      122        93
    ## Fats_and_oils      193   235      184       209
    ## Sugars             156   175      147       139

``` r
barplot(as.matrix(ukfood), beside=T, col=rainbow(nrow(ukfood)))
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-37-1.png)

``` r
barplot(as.matrix(ukfood),x, col=rainbow(10), pch=16)
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-38-1.png)

``` r
prcomp(ukfood)
```

    ## Standard deviations (1, .., p=4):
    ## [1] 919.13914 132.06254  88.58981  28.62021
    ## 
    ## Rotation (n x k) = (4 x 4):
    ##                 PC1        PC2         PC3         PC4
    ## England   0.4901572 -0.2808420  0.07019969  0.82215915
    ## Wales     0.4981704 -0.3475970  0.64010493 -0.47039166
    ## Scotland  0.5042356 -0.2482197 -0.76259165 -0.32029268
    ## N.Ireland 0.5072659  0.8594714  0.06157655 -0.01409337

``` r
pca<- prcomp(t(ukfood))
summary(pca)
```

    ## Importance of components:
    ##                             PC1      PC2      PC3       PC4
    ## Standard deviation     324.1502 212.7478 73.87622 4.189e-14
    ## Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
    ## Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00

PCA
===

``` r
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500) )
text(pca$x[,1], pca$x[,2],colnames(ukfood))
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-40-1.png)

``` r
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
```

\#\# values look for v %variation x PC

``` r
barplot(v, xlab="Principal Component", ylab="Percent Variation")
```

![](class8handson_files/figure-markdown_github/unnamed-chunk-42-1.png)
